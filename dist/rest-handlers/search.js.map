{"version":3,"sources":["../../server/rest-handlers/search.js"],"names":["search","express","Router","post","req","res","next","query","body","InvalidArgumentError","then","resultArray","result","forEach","user","username","locals","catch","error","module","exports"],"mappings":";;AAAA;;;;AACA;;AACA;;;;AAGA,IAAMA,SAASC,kBAAQC,MAAR,EAAf;;AAEAF,OAAOG,IAAP,CAAY,QAAZ,EAAsB,UAACC,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;AAAA,MAChCC,KADgC,GACtBH,IAAII,IADkB,CAChCD,KADgC;;;AAGxC,MAAI,CAACA,KAAL,EAAY;AACV,WAAOD,KAAK,IAAIG,4BAAJ,CAAyB,2BAAzB,EAAsD,GAAtD,CAAL,CAAP;AACD;;AAED,8BAAeF,KAAf,EAAsBG,IAAtB,CAA2B,UAACC,WAAD,EAAiB;AAC1C,QAAMC,SAAS,EAAf;AACAD,gBAAYE,OAAZ,CAAoB,UAACC,IAAD,EAAU;AAC5BF,aAAOE,KAAKC,QAAZ,IAAwBD,IAAxB;AACD,KAFD;;AAIAT,QAAIW,MAAJ,CAAWJ,MAAX,GAAoBA,MAApB;AACA,WAAON,MAAP;AACD,GARD,EASGW,KATH,CASS;AAAA,WAASX,KAAKY,KAAL,CAAT;AAAA,GATT;AAUD,CAjBD;;AAoBAlB,OAAOG,IAAP,CAAY,YAAZ,EAA0B,UAACC,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;AAC5C,iCACGI,IADH,CACQ,UAACE,MAAD,EAAY;AAChBP,QAAIW,MAAJ,CAAWJ,MAAX,GAAoBA,MAApB;AACA,WAAON,MAAP;AACD,GAJH;AAKD,CAND;;AAQAa,OAAOC,OAAP,GAAiBpB,MAAjB","file":"search.js","sourcesContent":["import express from 'express';\nimport { InvalidArgumentError } from '../utils/errors';\nimport { searchForUsers, searchSuggested } from '../firebase/search';\n\n\nconst search = express.Router();\n\nsearch.post('/users', (req, res, next) => {\n  const { query } = req.body;\n\n  if (!query) {\n    return next(new InvalidArgumentError('\\'query\\' cannot be empty', 401));\n  }\n\n  searchForUsers(query).then((resultArray) => {\n    const result = {};\n    resultArray.forEach((user) => {\n      result[user.username] = user;\n    });\n\n    res.locals.result = result;\n    return next();\n  })\n    .catch(error => next(error));\n});\n\n\nsearch.post('/suggested', (req, res, next) => {\n  searchSuggested()\n    .then((result) => {\n      res.locals.result = result;\n      return next();\n    });\n});\n\nmodule.exports = search;\n"]}